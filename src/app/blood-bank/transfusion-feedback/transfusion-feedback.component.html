<app-suit-header [IsSwitchWard]="true" *ngIf="!readonly"></app-suit-header>
<app-generic-close *ngIf="readonly"></app-generic-close>
<div class="container__wrapper p-0 position-relative" style="background-color: #fff;overflow-x: hidden;">
    <div class="page-header sticky-top bg-primary-50 shadow-sm justify-content-between" [ngStyle]="{ 'display': !readonly ? '' : 'none' }">
        <div class="d-flex align-items-center gap-4">
            <h2 class="page-heading d-flex align-items-center m-0 text-nowrap">
                Transfusion Feedback
            </h2>
            <div class="d-flex align-items-center gap-2">
                <label for="" class="form-label m-0 text-nowrap">ID No.</label>
                <div class="d-flex input-group">
                    <input id="ssn" type="text" class="form-control" placeholder="ID No."
                        (keydown.enter)="onSSNEnterPress($event)"  value="">
                    <button type="button" class="btn btn-secondary-fill btn-icon">
                        <img src="assets/images/icons/icon-search.svg" alt="">
                    </button>
                </div>
            </div>
        </div>
        <div class="d-flex align-items-center gap-2">
            <button *ngIf="IsFromBedsBoard" class="btn btn-main-fill" (click)="navigatetoBedBoard()">Beds Board</button>
            <button class="btn btn-main-outline" (click)="onViewClick()" *ngIf="patientData">View</button>
            <button class="btn btn-danger-outline" (click)="onClearClick()">Clear</button>
            <ng-container *appHasPermission="'Save'">
                <button class="btn btn-main-outline" (click)="onSaveClick()" *ngIf="patientData">{{FeedbackId === 0 ?
                    'Save'
                    : 'Modify'}}</button>
            </ng-container>
        </div>
    </div>


    <div class="doctor_worklist worklist_patientcard m-0 rounded-0 border-0 d-flex" *ngIf="patientData">
        <div class="d-flex align-items-center w-100">
            <div class="row mx-0 gx-0 align-items-center border-bottom w-100">
                <div class="w-max-content">
                    <div class="d-flex align-items-center p-2 py-1">
                        <div class="patient-photo me-3">
                            <img src="assets/images/icons/male.svg" alt="" class="position-relative"
                                style="height: 2rem;" *ngIf="patientData.Gender === 'Male'">
                            <img src="assets/images/icons/female.svg" alt="" class="position-relative"
                                style="height: 2rem;" *ngIf="patientData.Gender === 'Female'">
                        </div>
                        <div>
                            <p class="value fs-7 fw-bold w-100">{{patientData.PatientName}}</p>
                            <div class="d-flex align-items-center gap-2">
                                <p>{{patientData.Gender}} | {{patientData.FullAge}}{{patientData.AgeUOM}}</p>
                                <p>ID No. : <span class="fw-bold">{{patientData.SSN}}</span></p>
                            </div>
                            <div class="d-flex align-items-center gap-1">
                                <p><b>DOB</b> :</p>
                                <svg width="10" height="11" viewBox="0 0 10 11" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M8.26322 1.3606H7.69641V0.965985C7.69641 0.799562 7.6061 0.645704 7.45953 0.562492C7.31306 0.479173 7.13244 0.479173 6.98598 0.562492C6.8394 0.645704 6.7491 0.799559 6.7491 0.965985V1.36049L3.25071 1.3606V0.965983C3.25071 0.799559 3.16041 0.645701 3.01383 0.56249C2.86736 0.47917 2.68674 0.47917 2.54028 0.56249C2.3937 0.645701 2.3034 0.799557 2.3034 0.965983V1.36049L1.73659 1.3606C1.27604 1.3606 0.834325 1.54056 0.508675 1.86095C0.182912 2.18145 0 2.61604 0 3.06915V8.79133C0 9.24445 0.18292 9.67904 0.508675 9.99954C0.834325 10.3199 1.27604 10.5 1.73659 10.5H8.26341C8.72396 10.5 9.16568 10.3199 9.49133 9.99954C9.81709 9.67904 10 9.24445 10 8.79133V3.06915C10 2.61604 9.81708 2.18145 9.49133 1.86095C9.16568 1.54056 8.72396 1.3606 8.26341 1.3606L8.26322 1.3606ZM1.73809 2.29263H2.3049V2.99787L2.30479 2.99776C2.30479 3.16419 2.39509 3.31805 2.54167 3.40126C2.68825 3.48458 2.86876 3.48458 3.01533 3.40126C3.1618 3.31805 3.2521 3.16419 3.2521 2.99776V2.29252H6.74908V2.99776C6.74908 3.16419 6.83939 3.31805 6.98596 3.40126C7.13243 3.48458 7.31305 3.48458 7.45951 3.40126C7.60609 3.31805 7.69639 3.16419 7.69639 2.99776V2.29252H8.2632C8.47255 2.29252 8.67331 2.37432 8.82132 2.52005C8.96933 2.66567 9.05259 2.86319 9.05259 3.06916V4.48268H0.947001V3.06916C0.947001 2.86319 1.03026 2.66567 1.17827 2.52005C1.32628 2.37432 1.52703 2.29252 1.73639 2.29252L1.73809 2.29263ZM8.26322 9.56809H1.7364C1.52705 9.56809 1.32629 9.48629 1.17828 9.34067C1.03027 9.19494 0.947012 8.99742 0.947012 8.79144V5.41472H9.0526V8.79144C9.0526 8.99742 8.96934 9.19494 8.82133 9.34067C8.67332 9.48629 8.47257 9.56809 8.26321 9.56809H8.26322Z"
                                        fill="#368796" />
                                </svg>
                                <p class="m-0 fw-bold text-nowrap">
                                    {{patientData.DOB?.split('
                                    ')[0]}}</p>



                            </div>
                            <p class="m-0 fs-8">{{patientData.Nationality}} | Mobile :{{patientData.MobileNo}}</p>
                        </div>
                    </div>
                </div>
                <div class="col pe-0">
                    <div class="bg-white h-100 p-1" style="border-top-right-radius: 0.8rem;">
                        <div class="row mx-0 py-1 position-relative">
                            <div class="w-max-content">
                                <p class="label"> Ward. </p>
                                <p>{{patientData.Ward}}</p>
                            </div>
                            <div class="w-max-content">
                                <p class="label m-0"> Bed No. </p>
                                <p class="alert_animate fw-bold m-0 token">{{patientData.BedName}}</p>
                            </div>
                            <div class="col-3">
                                <p class="label"> Doctor Name </p>
                                <p class="color-highlight">{{patientData.Consultant}}</p>
                            </div>
                            <div class="col-2">
                                <p class="label">Blood group</p>
                                <p>{{getBloodGroup(patientData.BloodGroupId)}}</p>
                            </div>
                            <div class="col-2">
                                <p class="label">IP No</p>
                                <p>{{patientData.IPID}}</p>
                            </div>
                            <div class="col">
                                <p class="label">Operator</p>
                                <p></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="p-2" *ngIf="patientData">
        <div class="card card-style-1 rounded">
            <div class="card-header rounded-top justify-content-start min-height-unset py-2">
                <h5 class="card-heading">General</h5>
            </div>
            <div class="">
                <div class="row gx-0">
                    <div class="col-12 p-2 border-bottom-primary-200 pb-3">
                        <div class="row g-2">
                            <div class="col-lg-3 col-4">
                                <label for="" class="form-label">Bag Number</label>
                                <div class="d-flex input-group">
                                    <input id="textbox_bloodbag" type="text" class="form-control" placeholder="Search"
                                        aria-label="Search" [matAutocomplete]="autoBloodComponents"
                                        (keyup)="($event.key === 'ArrowUp' || $event.key === 'ArrowDown') ? $event.preventDefault() : searchBloodBags($event)"
                                        (change)="searchBloodBags($event)">
                                    <mat-autocomplete #autoBloodComponents="matAutocomplete">
                                        <mat-option *ngFor="let item of bloodBagsList" [value]="item.BagNumber"
                                            (onSelectionChange)="onBloodBagSelection(item)">
                                            {{item.BagNumber}}
                                        </mat-option>
                                    </mat-autocomplete>
                                    <button type="button" class="btn btn-secondary-fill btn-icon">
                                        <img src="assets/images/icons/icon-search.svg" alt="">
                                    </button>
                                </div>
                            </div>
                            <div class="col-lg-3 col-4">
                                <label for="" class="form-label">Quantity of Blood Transfused</label>
                                <input type="number" class="form-control" [(ngModel)]="feedbackData.Quantity">
                            </div>
                            <div class="col-lg-3 col-4">
                                <label for="" class="form-label">Bag issued Date & Time</label>
                                <div class="d-flex gap-2">
                                    <mat-form-field appearance="fill">
                                        <mat-label translate>dd-MMM-yyyy</mat-label>
                                        <input matInput class="" (click)="bagIssuedate.open()"
                                            [(ngModel)]="feedbackData.BagIssuedate" [matDatepicker]="bagIssuedate">
                                        <mat-datepicker-toggle matSuffix [for]="bagIssuedate">
                                        </mat-datepicker-toggle>
                                        <mat-datepicker #bagIssuedate></mat-datepicker>
                                    </mat-form-field>
                                    <input type="time" class="form-control" [(ngModel)]="feedbackData.BagIssuetime">
                                </div>
                            </div>
                            <div class="col-lg-3 col-4">
                                <label for="" class="form-label">Pre Blood Group</label>
                                <select name="" class="form-select" [(ngModel)]="feedbackData.preBloodgroup">
                                    <option value="0">Select</option>
                                    <option [value]="option.Id" *ngFor="let option of FetchTransfBloodgroupDataList">
                                        {{option.Names}}</option>
                                </select>
                            </div>
                            <div class="col-lg-3 col-4">
                                <label for="" class="form-label">Transfusion Commenced Date & Time</label>
                                <div class="d-flex gap-2">
                                    <mat-form-field appearance="fill">
                                        <mat-label translate>dd-MMM-yyyy</mat-label>
                                        <input matInput class="" (click)="commencedate.open()"
                                            [(ngModel)]="feedbackData.Commencedate" [matDatepicker]="commencedate">
                                        <mat-datepicker-toggle matSuffix [for]="commencedate">
                                        </mat-datepicker-toggle>
                                        <mat-datepicker #commencedate></mat-datepicker>
                                    </mat-form-field>
                                    <input type="time" class="form-control" [(ngModel)]="feedbackData.Commencetime">
                                </div>
                            </div>
                        </div>
                        <div class="row g-2 mt-1">
                            <div class="col-3">
                                <label for="" class="form-label">Pre Transfusion</label>
                                <span #preTransfusion
                                    class="textarea_box textarea_box_double bg-transparent p-2 rounded-2 d-block w-100"
                                    contenteditable="true" [innerHTML]="feedbackData.PreTransfusion"></span>
                            </div>
                            <div class="col-3">
                                <label for="" class="form-label">Crossmatch Type</label>
                                <span
                                    class="textarea_box textarea_box_double bg-transparent p-2 rounded-2 d-block w-100">
                                    <div *ngFor="let item of FetchTransfAntibiotDataList">
                                        <div class="custom_check  ms-auto d-flex align-items-center gap-2"
                                            [class.active]="item.isSelected">
                                            <svg width="16" height="16" viewBox="0 0 20 21" fill="none"
                                                xmlns="http://www.w3.org/2000/svg"
                                                (click)="item.isSelected = !item.isSelected" class="check_svg">
                                                <circle cx="10" cy="10.5" r="10" fill="#43BC94"></circle>
                                                <path
                                                    d="M9.85969 13.8389C10.1922 13.8374 10.5109 13.7054 10.747 13.4712L10.747 13.4713L10.7496 13.4685L18.7068 5.08439C18.825 4.96682 18.9188 4.8271 18.9829 4.67321C19.0473 4.51873 19.0804 4.35303 19.0804 4.18568C19.0804 4.01832 19.0473 3.85262 18.9829 3.69814C18.9186 3.5437 18.8243 3.40352 18.7055 3.28569C18.468 3.04958 18.1467 2.91704 17.8118 2.91704C17.4769 2.91704 17.1556 3.04958 16.918 3.28569L16.918 3.28564L16.9152 3.28862L9.85639 10.7804L8.06528 8.98932C7.95221 8.85834 7.81352 8.75187 7.65773 8.67649C7.50045 8.6004 7.32913 8.55764 7.15455 8.5509C6.97996 8.54416 6.80586 8.57357 6.64318 8.63731C6.4805 8.70104 6.33274 8.79771 6.2092 8.92126C6.08565 9.04481 5.98898 9.19256 5.92524 9.35524C5.86151 9.51792 5.83209 9.69202 5.83884 9.86661C5.84558 10.0412 5.88834 10.2125 5.96443 10.3698C6.03979 10.5255 6.14622 10.6642 6.27716 10.7773L8.95915 13.4707L8.9597 13.4712C9.07816 13.5887 9.21864 13.6817 9.3731 13.7447C9.52752 13.8078 9.69288 13.8398 9.85969 13.8389ZM9.85969 13.8389C9.85965 13.8389 9.85962 13.8389 9.85959 13.8389L9.85906 13.7139L9.85978 13.8389C9.85975 13.8389 9.85972 13.8389 9.85969 13.8389Z"
                                                    fill="white" stroke="white" stroke-width="0.25"></path>
                                            </svg>
                                            <p class="m-0 fs-7">{{item.Names}}</p>
                                        </div>
                                    </div>
                                </span>
                            </div>
                            <div class="col-3">
                                <label for="" class="form-label">Remarks</label>
                                <span #remarks
                                    class="textarea_box textarea_box_double bg-transparent p-2 rounded-2 d-block w-100"
                                    contenteditable="true" [innerHTML]="feedbackData.Remarks"></span>
                            </div>
                            <div class="col-3 text-end mt-4">

                                <div class="d-flex align-items-center justify-content-end h-100">
                                    <button class="btn btn-main-outline fs-8" (click)="openVitals()">View Vitals Pre
                                        Transfusion</button>
                                </div>
                                <!-- <a (click)="openVitals()">View Vitals Pre Transfusion</a> -->

                            </div>
                        </div>
                    </div>
                    <div class="col-12 p-2">
                        <div class="row align-items-end g-2">
                            <div class="col-lg-3 col-4">
                                <label for="" class="form-label">Post Blood Group</label>
                                <select name="" class="form-select" [(ngModel)]="feedbackData.Postbloodgroup">
                                    <option value="0">Select</option>
                                    <option [value]="option.Id" *ngFor="let option of FetchTransfBloodgroupDataList">
                                        {{option.Names}}</option>
                                </select>
                            </div>
                            <div class="col-lg-3 col-4">
                                <label for="" class="form-label">Reaction Reported Date & Time</label>
                                <div class="d-flex gap-2">
                                    <mat-form-field appearance="fill">
                                        <mat-label translate>dd-MMM-yyyy</mat-label>
                                        <input matInput class="" (click)="reactionReported.open()"
                                            [(ngModel)]="feedbackData.ReactionReported"
                                            [matDatepicker]="reactionReported">
                                        <mat-datepicker-toggle matSuffix [for]="reactionReported">
                                        </mat-datepicker-toggle>
                                        <mat-datepicker #reactionReported></mat-datepicker>
                                    </mat-form-field>
                                    <input type="time" class="form-control"
                                        [(ngModel)]="feedbackData.ReactionReportedtime">
                                </div>
                            </div>
                            <div class="col-lg-3 col-4">
                                <label for="" class="form-label">Transfusion Concluded Date & Time</label>
                                <div class="d-flex gap-2">
                                    <mat-form-field appearance="fill">
                                        <mat-label translate>dd-MMM-yyyy</mat-label>
                                        <input matInput class="" (click)="concludeddate.open()"
                                            [(ngModel)]="feedbackData.Concludeddate" [matDatepicker]="concludeddate">
                                        <mat-datepicker-toggle matSuffix [for]="concludeddate">
                                        </mat-datepicker-toggle>
                                        <mat-datepicker #concludeddate></mat-datepicker>
                                    </mat-form-field>
                                    <input type="time" class="form-control" [(ngModel)]="feedbackData.Concludedtime">
                                </div>
                            </div>
                            <div class="col-lg-3 col-4 d-flex align-items-end">
                                <!-- <div class="d-flex gap-2">
                                    <label for="" class="form-label">Reaction Observed</label>
                                    <div class="clinical_toggle toggle__switch switch-sm d-inline-flex align-self-center">
                                        <button class="btn" [class.selected]="feedbackData.isReactionObserved"
                                            (click)="feedbackData.isReactionObserved = true;">Yes</button>
                                        <button class="btn" [class.selected]="!feedbackData.isReactionObserved"
                                            (click)="feedbackData.isReactionObserved = false;">No</button>
                                    </div>
                                </div> -->
                                <div class="form-check form-switch d-flex gap-2 align-items-center">
                                    <input class="form-check-input mb-1" type="checkbox" (click)="toggleRejectedSamples()"
                                        role="switch" id="flexSwitchCheckChecked" [checked]="feedbackData.isReactionObserved"
                                        >
                                    <label class="form-check-label fs-8" for="flexSwitchCheckChecked">Reaction Observed</label>
                                    <button class="btn btn-main-fill" (click)="openReactionReport()" *ngIf="feedbackData.isReactionObserved && bloodOrderID">Reaction Report</button>
                                </div>
                            </div>
                        </div>
                        <div class="row g-2 mt-1 align-items-end">
                            <div class="col-lg-3 col-4">
                                <label for="" class="form-label">Post Transfusion</label>
                                <span #postTransfusion
                                    class="textarea_box textarea_box_double bg-transparent p-2 rounded-2 d-block w-100"
                                    contenteditable="true" [innerHTML]="feedbackData.PostTransfusion"></span>
                            </div>
                            <div class="col text-end">
                                <!-- <p>
                                    <a (click)="openVitals()">View Vitals Post Transfusion</a>
                                </p> -->
                                <div class="inline_legend">
                                    <button class="btn btn-main-outline fs-8" (click)="openVitals()">View Vitals Post
                                        Transfusion</button>
                                </div>
                            </div>
                        </div>
                        <div class="row g-2">
                            <div class="col-3">
                                <label for="" class="form-label">Witness Nurse</label>
                                <div class="d-flex input-group">
                                    <input id="textbox_witnessnurse" type="text" placeholder="search"
                                        class="form-control pe-2" aria-label="Search" [matAutocomplete]="nurse"
                                        (keyup)="($event.key === 'ArrowUp' || $event.key === 'ArrowDown') ? $event.preventDefault() : onSearchDoctorsAll($event)">
                                    <mat-autocomplete #nurse="matAutocomplete">
                                        <mat-option *ngFor="let item of doctorsList" [value]="item.Name"
                                            (onSelectionChange)="onNurseSelection(item)">
                                            {{item.Name}}
                                        </mat-option>
                                    </mat-autocomplete>
                                    <button type="button" id="button-addon2" class="btn btn-secondary-fill btn-icon">
                                        <img src="assets/images/icons/icon-search.svg" alt="">
                                    </button>
                                </div>
                            </div>
                            <div class="col-3">
                                <label for="" class="form-label">Witness Doctor</label>
                                <div class="d-flex input-group">
                                    <input id="textbox_witnessdoctor" type="text" placeholder="search"
                                        class="form-control pe-2" aria-label="Search" [matAutocomplete]="doctor"
                                        (keyup)="($event.key === 'ArrowUp' || $event.key === 'ArrowDown') ? $event.preventDefault() : onSearchDoctorsAll($event)">
                                    <mat-autocomplete #doctor="matAutocomplete">
                                        <mat-option *ngFor="let item of doctorsList" [value]="item.Name"
                                            (onSelectionChange)="onDoctorSelection(item)">
                                            {{item.Name}}
                                        </mat-option>
                                    </mat-autocomplete>
                                    <button type="button" id="button-addon2" class="btn btn-secondary-fill btn-icon">
                                        <img src="assets/images/icons/icon-search.svg" alt="">
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal" id="viewModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" style="max-width:65%">
        <div class="modal-content">
            <div class="modal-header p-2">
                <h5 class="modal-title clr-primary-600 fs-6" translate>View</h5>
                <div class="d-flex align-items-center gap-2">
                    <button type="button" data-bs-dismiss="modal" aria-label="Close" class="btn-close"></button>
                </div>
            </div>
            <div class="modal-body p-3">
                <div class="table-cards_div text-start d-flex mx-0 mt-0 g-2 p-2 position-relative"
                    *ngFor="let item of FetchTransfusionfeedBackFFDataList;let i=index">
                    <div class="row mx-0 g-2 w-100">
                        <div class="col-1" style="max-width: 4rem;">
                            <p class="label">ID</p>
                            <p><a href="#" (click)="$event.preventDefault();onSelectRecord(item)">{{
                                    item.FeedbackId }}</a></p>
                        </div>
                        <div class="col-2">
                            <p class="label">Name</p>
                            <p>{{ item.PatientFullName }}</p>
                        </div>
                        <div class="col-2">
                            <p class="label">Blood Bag</p>
                            <p>{{ item.BagNumber }}</p>
                        </div>
                        <div class="col-2">
                            <p class="label">Bag IssueDate</p>
                            <p>{{ item.BagIssuedate }}</p>
                        </div>

                        <div class="col-3">
                            <p class="label">DoctorName</p>
                            <p>{{ item.DoctorName }}</p>
                        </div>
                        <div class="col-2">
                            <p class="label">Date</p>
                            <p>{{ item.CreateDate | date: 'dd-MMM-yyyy' }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal" id="errorMsg" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-toast modal-toast-success">
        <div class="modal-content">
            <img class="modal-header-icon" src="assets/images/icons/toast-info.svg" alt="">
            <div class="modal-body">
                <p *ngIf="errorMessages.length === 1">{{errorMessages[0]}}</p>
                <ul *ngIf="errorMessages.length > 1">
                    <li *ngFor="let error of errorMessages; let i = index"> {{error}}</li>
                </ul>
                <div class="modal-footer">
                    <a href="javascript:void(0)" type="button" class="btn btn-main-outline"
                        data-bs-dismiss="modal">{{langData?.common?.ok}}</a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal" id="savemsg" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-toast modal-toast-success">
        <div class="modal-content">
            <img class="modal-header-icon" src="assets/images/icons/toast-success.svg" alt="">
            <div class="modal-body">
                <p>Saved successfully</p>
                <div class="modal-footer">
                    <a href="javascript:void(0)" type="button" class="btn btn-main-outline"
                        data-bs-dismiss="modal">Ok</a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade vitalsModal" id="vitalsModal" tabindex="-1" aria-labelledby="vitalsLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" style="max-width: 95%;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" translate>Vitals</h5>
                <div class="ms-auto d-flex align-items-center">
                    <button class="btn btn-danger-outline" (click)="clearVital()">Clear</button>
                    <button class="btn btn-main-outline ms-2" (click)="saveVitals()">Save</button>
                    <button type="button" class="btn-close ms-3" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
            </div>
            <div class="modal-body px-0" *ngIf="IsVitalDisplay">
                <div class="px-3">
                    <div class="validation_err" *ngIf="showVitalsValidation">
                        <p class="m-0 fs-7">Please enter values for BP-SYSTOLIC, BP-DIASTOLIC & Temperature</p>
                    </div>
                    <div class="validation_err" *ngIf="showParamValidationMessage">
                        <p class="m-0 fs-7">{{parameterErrorMessage}} </p>
                    </div>
                    <app-vitals (receivedData)="receivedData($event)"></app-vitals>
                    <div class="col-lg-12 pe-0">
                        <div class="vitalgraph_Table pe-3 horizontalScroll">
                            <table class="table border-0">
                                <tbody>
                                    <tr *ngFor="let vitaldate of tableVitalsListFiltered; let i = index">
                                        <td class="position-relative" style="padding:2rem 0 0 0 !Important;">
                                            <span class="table-date-heading1">
                                                <span>
                                                    <svg width="19" height="19" viewBox="0 0 19 19" fill="none"
                                                        xmlns="http://www.w3.org/2000/svg">
                                                        <path
                                                            d="M14.9847 2.49861H13.9809V1.7883C13.9809 1.48874 13.821 1.21179 13.5614 1.06201C13.3021 0.912035 12.9822 0.912035 12.7228 1.06201C12.4632 1.21179 12.3033 1.48873 12.3033 1.7883V2.49841L6.10788 2.4986V1.78829C6.10788 1.48873 5.94796 1.21179 5.68838 1.06201C5.42899 0.91203 5.10913 0.91203 4.84976 1.06201C4.59017 1.21179 4.43025 1.48873 4.43025 1.78829V2.4984L3.42647 2.4986C2.61087 2.4986 1.82861 2.82254 1.25191 3.39923C0.675 3.97614 0.351074 4.75839 0.351074 5.574V15.8739C0.351074 16.6895 0.675015 17.4718 1.25191 18.0487C1.82861 18.6254 2.61087 18.9495 3.42647 18.9495H14.9851C15.8007 18.9495 16.5829 18.6254 17.1596 18.0487C17.7365 17.4718 18.0605 16.6895 18.0605 15.8739V5.574C18.0605 4.75839 17.7365 3.97614 17.1596 3.39923C16.5829 2.82252 15.8007 2.4986 14.9851 2.4986L14.9847 2.49861ZM3.42913 4.17625H4.43291V5.44569L4.43272 5.4455C4.43272 5.74506 4.59264 6.02201 4.85222 6.17179C5.1118 6.32176 5.43147 6.32176 5.69104 6.17179C5.95042 6.02201 6.11035 5.74507 6.11035 5.4455V4.17606H12.3033V5.4455C12.3033 5.74506 12.4632 6.02201 12.7228 6.17179C12.9822 6.32176 13.302 6.32176 13.5614 6.17179C13.821 6.02201 13.9809 5.74507 13.9809 5.4455V4.17606H14.9847C15.3554 4.17606 15.711 4.3233 15.9731 4.58561C16.2352 4.84773 16.3826 5.20326 16.3826 5.57402V8.11834H2.02815V5.57402C2.02815 5.20327 2.17559 4.84773 2.43771 4.58561C2.69983 4.3233 3.05536 4.17606 3.42611 4.17606L3.42913 4.17625ZM14.9847 17.2721H3.42613C3.05539 17.2721 2.69985 17.1248 2.43773 16.8627C2.17561 16.6004 2.02817 16.2449 2.02817 15.8741V9.79602H16.3827V15.8741C16.3827 16.2449 16.2352 16.6004 15.9731 16.8627C15.711 17.1248 15.3555 17.2721 14.9847 17.2721H14.9847Z"
                                                            fill="#ffffff"></path>
                                                    </svg>
                                                </span>
                                                <span>{{(patientData?.PatientType == '2' || patientData.PatientType ==
                                                    '4') ?
                                                    vitaldate.VitalSignDateOnly :
                                                    vitaldate.VisitDate}}</span>
                                            </span>

                                            <div>
                                                <div class="fixed_alter_header bg-primary-50">
                                                    <div class="row gx-2 p-2 mx-0">
                                                        <div class="col-1">
                                                            <p class="label m-0">{{langData?.common?.Time}}</p>
                                                        </div>
                                                        <div class="col-2">
                                                            <p class="label m-0">
                                                                {{langData?.common?.BPSystolic}}/{{langData?.common?.BPDiastolic}}
                                                            </p>
                                                        </div>
                                                        <div class="col-1">
                                                            <p class="label m-0">Temperature</p>
                                                        </div>
                                                        <div class="col-1">
                                                            <p class="label m-0">{{langData?.common?.Pulse}}</p>
                                                        </div>
                                                        <div class="col-1">
                                                            <p class="label m-0">{{langData?.common?.Respiration}}</p>
                                                        </div>
                                                        <div class="col-1">
                                                            <p class="label m-0">{{langData?.common?.SPO2}}</p>
                                                        </div>
                                                        <div class="col-1">
                                                            <p class="label m-0">{{langData?.common?.O2FlowRate}}</p>
                                                        </div>
                                                        <div class="col-1">
                                                            <p class="label m-0">Ventilated</p>
                                                        </div>
                                                        <div class="col-1">
                                                            <p class="label m-0">Bipap</p>
                                                        </div>
                                                        <div class="col-1">
                                                            <p class="label m-0">Cpap</p>
                                                        </div>
                                                        <div class="col-1">
                                                            <p class="label m-0">{{langData?.common?.Score}}</p>
                                                        </div>

                                                    </div>
                                                </div>
                                                <div class="">
                                                    <div class="row gx-2 mx-0 p-2 my-2 table-cards_div"
                                                        *ngFor="let vital of filterFunction(tableVitalsList, (patientData.PatientType == '2' || patientData.PatientType == '4') ? vitaldate.VitalSignDateOnly : vitaldate.VisitID); let i = index">
                                                        <div
                                                            class="px-2 py-1 d-flex align-items-center justify-content-between ">
                                                            <div class="col-1">
                                                                <p class="m-0">{{vital.Time}}</p>
                                                            </div>
                                                            <div class="col-2">
                                                                <p class="m-0">{{vital.BPSystolic}} /
                                                                    {{vital.BPDiastolic}}</p>
                                                            </div>
                                                            <div class="col-1">
                                                                <p class="m-0">{{vital.Temparature}}</p>
                                                            </div>
                                                            <div class="col-1">
                                                                <p class="m-0">{{vital.Pulse}}</p>
                                                            </div>
                                                            <div class="col-1">
                                                                <p class="m-0">{{vital.Respiration}}</p>
                                                            </div>
                                                            <div class="col-1">
                                                                <p class="m-0">{{vital?.SPO2}}</p>
                                                            </div>
                                                            <div class="col-1">
                                                                <p class="m-0">{{vital.O2FlowRate}}</p>
                                                            </div>
                                                            <div class="col-1">
                                                                <p class="m-0">{{vital?.Ventilated}}</p>
                                                            </div>
                                                            <div class="col-1">
                                                                <p class="m-0">{{vital?.Bipap}}</p>
                                                            </div>
                                                            <div class="col-1">
                                                                <p class="m-0">{{vital?.Bipap}}</p>
                                                            </div>
                                                            <div class="col-1">
                                                                <p class="m-0">{{vital?.Bipap}}</p>
                                                            </div>
                                                        </div>
                                                        <div
                                                            [ngClass]="vital.FinalRemarks === '1' ? 'bg-primary-50 px-2 py-1 endblock' :  'bg-primary-50 px-2 py-1 endblock d-none'">
                                                            <div class="d-flex align-items-start w-100">
                                                                <div class="col-1">
                                                                    <p for="" class="label">Remarks:</p>
                                                                </div>
                                                                <div class="col-2"
                                                                    *ngIf="vital.BPSysDiastolicRemarks!=''">
                                                                    <div class="d-flex align-items-center"
                                                                        *ngIf="vital.BPSysDiastolicRemarks!=''">
                                                                        <p for="" class="label">BP:</p>
                                                                        <p for="" class="form-label text-uppercase">
                                                                            {{vital.BPSysDiastolicRemarks}}</p>
                                                                    </div>
                                                                </div>
                                                                <div class="col-1" *ngIf="vital.TemparatureRemarks!=''">
                                                                    <div class="d-flex"
                                                                        *ngIf="vital.TemparatureRemarks!=''">
                                                                        <p for="" class="label">Temp:</p>
                                                                        <p for="" class="form-label text-uppercase">
                                                                            {{vital.TemparatureRemarks}}</p>
                                                                    </div>
                                                                </div>
                                                                <div class="col-1">
                                                                    <div class=" d-flex "
                                                                        *ngIf="vital.PulseRemarks!=''">
                                                                        <p for="" class="label">Pulse:</p>
                                                                        <p for="" class="form-label text-uppercase">
                                                                            {{vital.PulseRemarks}}</p>
                                                                    </div>
                                                                </div>
                                                                <div class="col-1">
                                                                    <div class="d-flex"
                                                                        *ngIf="vital.RespirationRemarks!=''">
                                                                        <p for="" class="label">Respiration:</p>
                                                                        <p for="" class="form-label text-uppercase">
                                                                            {{vital.RespirationRemarks}}</p>
                                                                    </div>
                                                                </div>
                                                                <div class="col-1">
                                                                    <div class="d-flex" *ngIf="vital.SPO2Remarks!=''">
                                                                        <p for="" class="label">SPO2:</p>
                                                                        <p for="" class="form-label text-uppercase">
                                                                            {{vital.SPO2Remarks}}</p>
                                                                    </div>
                                                                </div>
                                                                <div class="col-1">
                                                                    <div class="d-flex"
                                                                        *ngIf="vital.O2FlowRateRemarks!=''">
                                                                        <p for="" class="label">O2FlowRate:</p>
                                                                        <p for="" class="form-label text-uppercase">
                                                                            {{vital.O2FlowRateRemarks}}</p>
                                                                    </div>
                                                                </div>
                                                                <div class="col-1">

                                                                </div>
                                                                <div class="col-1">

                                                                </div>
                                                                <div class="col-1">

                                                                </div>
                                                                <div class="col-1">

                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal" id="saveVitalsMsg" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-toast modal-toast-success">
        <div class="modal-content">
            <img class="modal-header-icon" src="assets/images/icons/toast-success.svg" alt="">
            <div class="modal-body">
                <p>Vitals Saved Successfully</p>
                <div class="modal-footer">
                    <a href="javascript:void(0)" type="button" class="btn btn-main-outline"
                        data-bs-dismiss="modal">Ok</a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal" id="errorMsg" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-toast modal-toast-success">
        <div class="modal-content">
            <img class="modal-header-icon" src="assets/images/icons/toast-info.svg" alt="">
            <div class="modal-body">
                <p *ngIf="errorMessages.length === 1">{{errorMessages[0]}}</p>
                <ul *ngIf="errorMessages.length > 1">
                    <li *ngFor="let error of errorMessages; let i = index"> {{error}}</li>
                </ul>
                <div class="modal-footer">
                    <a href="javascript:void(0)" type="button" class="btn btn-main-outline"
                        data-bs-dismiss="modal">{{langData?.common?.ok}}</a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade refill_modal" data-bs-abackdrop="static" data-bs-keyboard="false" id="reactionReportModal"
    tabindex="-1">
    <div class="modal-dialog modal-dialog-centered" style="max-width: 90%;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Transfusion Reaction Report</h5>
                <div class="actions ms-auto d-flex gap-2 flex-wrap align-items-center justify-content-end">
                    <button class="btn btn-danger-outline" (click)="onReactionFormClearClick()" *ngIf="!readonly">{{langData?.common?.Clear}}</button>
                    <button class="btn btn-main-outline" (click)="onReactionFormSaveClick()" *ngIf="!readonly">{{langData?.common?.Save}}</button>
                    <button type="button" class="btn-close" *ngIf="FeedbackId !== 0" (click)="closeReactionForm()" aria-label="Close"></button>
                </div>
            </div>
            <div class="modal-body p-2">
               <app-transfusion-reaction-report *ngIf="showReactionReport" #reactionForm (onSaveForm)="onReactionFormSaved()"></app-transfusion-reaction-report>
            </div>
        </div>
    </div>
</div>