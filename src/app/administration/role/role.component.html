
<app-header [InputHome]="true" [IsSwitchWard]="false"></app-header>
<!--Container-->
<div class="container__wrapper p-0" style="background-color: #fff;">
    <div class="page-header sticky-top bg-primary-50 shadow-sm justify-content-between">
        <h2 class="page-heading d-flex align-items-center m-0">
         Role
        </h2>                       
        <div class="d-flex align-items-center gap-2">      
            <button class="btn btn-main-fill" (click)="navigatetoRoleMapping()">User Role Mapping</button>
            <button class="btn btn-danger-outline" (click)="clear()">Clear</button>                  
            <button class="btn btn-main-outline" (click)="SaveEmployeeHospitals()">Save</button>                  
        </div>
    </div>
    <div class="p-2 pb-0" [formGroup]="roleForm" *ngIf="showContent">
         <div class="row g-2">
            <div class="col-4">
               <label for="" class="form-label">Role Name</label>
               <div class="input-group">
                <input type="text" class="form-control" [matAutocomplete]="roleauto"
                    formControlName="RoleName" placeholder="Role Name"
                    (keyup)="($event.key === 'ArrowUp' || $event.key === 'ArrowDown') ? $event.preventDefault() : searchRole($event)">
                <mat-autocomplete #roleauto="matAutocomplete">
                    <mat-option *ngFor="let item of roleList"
                        (onSelectionChange)="onRoleSelected(item)">
                        {{item.RoleName}}
                    </mat-option>
                </mat-autocomplete>
                <button type="button" id="button-addon2"
                    class="btn btn-secondary-fill btn-icon">
                    <img src="assets/images/icons/icon-search.svg" alt="">
                </button>
            </div>
            </div>
            <div class="col-4">
                <label for="" class="form-label">Module</label>
                <div class="dropdown custom_dropdown">
                    <select name="" class="form-select pe-5" id="" formControlName="ModuleId" (change)="moduleChange($event)">
                        <option value="">{{langData?.common?.Select}}</option>
                        <option *ngFor="let e of FetchPatientFolderReasonsDataList" [value]="e.ID">
                            {{e.Name}}
                        </option>
                    </select>
                </div>
            </div>
            <div class="col-4 d-none">
               <label for="" class="form-label">Features</label>
               <input type="text" class="form-control" formControlName="Features">
            </div>
         </div>
         <div class="row gx-2 mt-2">
            <div class="col">
               <textarea name="" class="form-control" formControlName="Description" rows="2" placeholder="Description" id=""></textarea>
            </div>
            <div class="w-max-content">
                <label for="" class="form-label">Blocked</label>
                <div class="custom_toggle">
                    <input type="checkbox" (click)="toggleBlocked()" class="toggle" id="toggle5" [checked]="blockedToggle ? true : false" />
                    <label for="toggle5">
                        <span class="on">Yes</span>
                        <span class="off">No</span>
                    </label>
                </div>
            </div>
         </div>

         <div class="card card-style-1 rounded mt-2">
            <div class="card-header rounded-top justify-content-between py-1 min-height-unset">
               <h5 class="card-heading">Feature</h5>
                <div class="CommanSearch__form bg-white ps-2 grey height-unset">
                    <svg id="button-addon2" width="20" height="20" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10.8609 2.49805C15.7521 2.49805 19.7218 6.46772 19.7218 11.3589C19.7218 16.2501 15.7521 20.2198 10.8609 20.2198C5.96968 20.2198 2 16.2501 2 11.3589C2 6.46772 5.96968 2.49805 10.8609 2.49805ZM10.8609 18.2507C14.6681 18.2507 17.7527 15.1662 17.7527 11.3589C17.7527 7.55072 14.6681 4.46713 10.8609 4.46713C7.05267 4.46713 3.96909 7.55072 3.96909 11.3589C3.96909 15.1662 7.05267 18.2507 10.8609 18.2507ZM19.2147 18.3206L22 21.1049L20.6069 22.498L17.8226 19.7128L19.2147 18.3206Z" fill="#368796"></path>
                    </svg>
                    <input type="text" aria-label="Search" class="CommonSearch__input form-control ps-0" placeholder="Search" formControlName="SearchText">
                </div>
                <div class="custom_check d-flex align-items-center gap-1" (click)="toggleSelectAll()" [class.active]="selectAllActive">
                    <svg width="16" height="16" viewBox="0 0 20 21" fill="none" xmlns="http://www.w3.org/2000/svg" class="check_svg"><circle cx="10" cy="10.5" r="10" fill="#43BC94"></circle><path d="M9.85969 13.8389C10.1922 13.8374 10.5109 13.7054 10.747 13.4712L10.747 13.4713L10.7496 13.4685L18.7068 5.08439C18.825 4.96682 18.9188 4.8271 18.9829 4.67321C19.0473 4.51873 19.0804 4.35303 19.0804 4.18568C19.0804 4.01832 19.0473 3.85262 18.9829 3.69814C18.9186 3.5437 18.8243 3.40352 18.7055 3.28569C18.468 3.04958 18.1467 2.91704 17.8118 2.91704C17.4769 2.91704 17.1556 3.04958 16.918 3.28569L16.918 3.28564L16.9152 3.28862L9.85639 10.7804L8.06528 8.98932C7.95221 8.85834 7.81352 8.75187 7.65773 8.67649C7.50045 8.6004 7.32913 8.55764 7.15455 8.5509C6.97996 8.54416 6.80586 8.57357 6.64318 8.63731C6.4805 8.70104 6.33274 8.79771 6.2092 8.92126C6.08565 9.04481 5.98898 9.19256 5.92524 9.35524C5.86151 9.51792 5.83209 9.69202 5.83884 9.86661C5.84558 10.0412 5.88834 10.2125 5.96443 10.3698C6.03979 10.5255 6.14622 10.6642 6.27716 10.7773L8.95915 13.4707L8.9597 13.4712C9.07816 13.5887 9.21864 13.6817 9.3731 13.7447C9.52752 13.8078 9.69288 13.8398 9.85969 13.8389ZM9.85969 13.8389C9.85965 13.8389 9.85962 13.8389 9.85959 13.8389L9.85906 13.7139L9.85978 13.8389C9.85975 13.8389 9.85972 13.8389 9.85969 13.8389Z" fill="white" stroke="white" stroke-width="0.25"></path></svg>                          
                    <p class="fs-7">Select all</p>
                </div>
            </div>
            <div class="p-1 features_list d-flex flex-column gap-1">
                <div class="border p-1 rounded" *ngFor="let feature of filteredFeatures()">
                  <div class="row mx-0 gx-2 justify-content-between align-items-center">
                    <div class="col-4">
                        <div class="custom_check d-flex align-items-center gap-1" [class.active]="feature.selected" (click)="toggleAllButtons(feature)">
                            <svg width="16" height="16" viewBox="0 0 20 21" fill="none" xmlns="http://www.w3.org/2000/svg" class="check_svg"><circle cx="10" cy="10.5" r="10" fill="#43BC94"></circle><path d="M9.85969 13.8389C10.1922 13.8374 10.5109 13.7054 10.747 13.4712L10.747 13.4713L10.7496 13.4685L18.7068 5.08439C18.825 4.96682 18.9188 4.8271 18.9829 4.67321C19.0473 4.51873 19.0804 4.35303 19.0804 4.18568C19.0804 4.01832 19.0473 3.85262 18.9829 3.69814C18.9186 3.5437 18.8243 3.40352 18.7055 3.28569C18.468 3.04958 18.1467 2.91704 17.8118 2.91704C17.4769 2.91704 17.1556 3.04958 16.918 3.28569L16.918 3.28564L16.9152 3.28862L9.85639 10.7804L8.06528 8.98932C7.95221 8.85834 7.81352 8.75187 7.65773 8.67649C7.50045 8.6004 7.32913 8.55764 7.15455 8.5509C6.97996 8.54416 6.80586 8.57357 6.64318 8.63731C6.4805 8.70104 6.33274 8.79771 6.2092 8.92126C6.08565 9.04481 5.98898 9.19256 5.92524 9.35524C5.86151 9.51792 5.83209 9.69202 5.83884 9.86661C5.84558 10.0412 5.88834 10.2125 5.96443 10.3698C6.03979 10.5255 6.14622 10.6642 6.27716 10.7773L8.95915 13.4707L8.9597 13.4712C9.07816 13.5887 9.21864 13.6817 9.3731 13.7447C9.52752 13.8078 9.69288 13.8398 9.85969 13.8389ZM9.85969 13.8389C9.85965 13.8389 9.85962 13.8389 9.85959 13.8389L9.85906 13.7139L9.85978 13.8389C9.85975 13.8389 9.85972 13.8389 9.85969 13.8389Z" fill="white" stroke="white" stroke-width="0.25"></path></svg>                          
                            <h6 class="clr-primary-600 m-0 fs-7">{{ feature.FeatureName }}</h6>
                        </div>
                    </div>
                    <div class="col-8">
                      <div class="d-flex align-items-center gap-2 justify-content-end flex-wrap">
                        <button *ngFor="let button of getFeatureFunctions(feature.FeatureID)" [class.pill_btn]="button.selected" (click)="setFunctionStatus(button, feature)" class="btn btn-main-outline lh-1 min-width-unset">
                            {{ button.FunctionName }}
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
         </div>
    </div>
</div>

<div class="modal" id="savemsg" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-toast modal-toast-success">
        <div class="modal-content">
            <img class="modal-header-icon" src="assets/images/icons/toast-success.svg" alt="">
            <div class="modal-body">
                <p>Role Saved successfully</p>
                <div class="modal-footer">
                    <a href="javascript:void(0)" type="button" class="btn btn-main-outline"
                        data-bs-dismiss="modal" (click)="clear()">Ok</a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal" id="errorMessagesModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-toast modal-toast-success">
        <div class="modal-content">
            <img class="modal-header-icon" src="assets/images/icons/toast-info.svg" alt="">
            <div class="modal-body">
                <p>{{error}}</p>
                <div class="modal-footer">
                    <a href="javascript:void(0)" type="button" class="btn btn-main-outline"
                        data-bs-dismiss="modal">{{langData?.common?.ok}}</a>
                </div>
            </div>
        </div>
    </div>
</div>